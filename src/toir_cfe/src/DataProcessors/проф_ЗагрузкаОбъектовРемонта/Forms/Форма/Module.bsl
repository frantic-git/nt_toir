
//++ Проф-ИТ, #33, Башинская А., 13.10.2023	

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура КомандаЗагрузить(Команда)  
	
	Если Не ЗначениеЗаполнено(Объект.Организация) Тогда
		ПоказатьПредупреждение(, "Заполните организацию.");    
		Возврат;
	КонецЕсли;
	
	РезультатЗагрузки = "";
	КомандаЗагрузитьНаСервере();
	
	РезультатЗагрузки = СтрШаблон("%1 %2Запись объектов ремонта завершена.", РезультатЗагрузки, Символы.ПС);  
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Процедура ЗаполнитьНормативыПланирования(ОбъектОР, ОбъектНайден)

	СтруктураИзменения = Новый Структура;
	СтруктураИзменения.Вставить("МодифицированностьПредшествующихРемонтов", Ложь);
	СтруктураИзменения.Вставить("МодифицированностьРемЦиклов", Ложь);
	СтруктураИзменения.Вставить("МодифицированностьЗамещаемыхРемонтов", Ложь);
	СтруктураИзменения.Вставить("МодифицированностьЗапчастейОР", Ложь);
	СтруктураИзменения.Вставить("МодифицированностьНормативныхЗатратПоЗапчастям", Ложь);
	СтруктураИзменения.Вставить("МодифицированностьГарантий", Ложь);
	СтруктураИзменения.Вставить("МодифицированностьНормРемонтов", Ложь);
	
	Отказ = Ложь;
	Если ОбъектНайден Тогда 
		ТекТиповойОР  = ОбъектОР.ТиповойОР;
		ПредТиповойОР = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ОбъектОР.Ссылка, "ТиповойОР");
	Иначе
		ТекТиповойОР  = Справочники.торо_ТиповыеОР.ПустаяСсылка();         
		ПредТиповойОР = Справочники.торо_ТиповыеОР.ПустаяСсылка(); 
	КонецЕсли;
		
	ОбъектОР.ОбновитьТехническиеДанные(ТекТиповойОР, СтруктураИзменения);
	ОбъектОР.ПроверитьЗаполнитьНаСервере(СтруктураИзменения, Отказ);
	ОбъектОР.ПередЗаписьюФормы(СтруктураИзменения, Отказ);
	ОбъектОР.ПриЗаписиФормы(СтруктураИзменения, ПредТиповойОР, Отказ);
		
КонецПроцедуры

// Процедура записывает логи о загрузке данных из файла для последующего вывода
// Параметры:
// ТекстСообщения - текст записываемого сообщения
// НомерСтроки - по данной строке идет запись сообщений
// Приоритет - 1 - ошибка, 2 - предупреждение, 3 - общая информация, 4 - итоговое сообщение
//
&НаСервере
Процедура ЗаписатьСообщение(ТекстСообщения, НомерСтроки, Приоритет)
	
	НСтр = ТаблицаСообщенийПоСтрокам.Добавить();
	НСтр.Сообщение = ТекстСообщения;
	НСтр.Номер = НомерСтроки;
	НСтр.Приоритет = Приоритет;
	
КонецПроцедуры

&НаСервере
Процедура ВывестиРезультатыЗагрузки()
	
	ТаблицаСообщенийПоСтрокам.Сортировать("Номер, Приоритет");   
	ПредСтрока = Неопределено;
	Для Каждого Стр Из ТаблицаСообщенийПоСтрокам Цикл
		Если ПредСтрока <> Неопределено
		И Стр.Номер <> ПредСтрока.Номер Тогда
			РезультатЗагрузки = РезультатЗагрузки + Символы.ПС; 
		КонецЕсли; 
		
		РезультатЗагрузки = РезультатЗагрузки + Стр.Сообщение + Символы.ПС;   
		
		ПредСтрока = Стр;
	КонецЦикла;
	
КонецПроцедуры

&НаСервере
Процедура КомандаЗагрузитьНаСервере()
	
	СообщениеОшибки = ""; 
	СообщенияЗагрузки = "";     
	СообщенияПредупреждения = "";
	ЕстьНезаполненныеЗначения = Ложь;
	МассивОбязательныхКолонок = ПолучитьСписокОбязательныхКолонок();
	МассивЭлементовСправочника = Новый Соответствие;
	СтрокиИзФайла.Очистить();
	ТаблицаСообщенийПоСтрокам.Очистить();
	
	Для НомерСтроки = 2 По ТабличныйДокумент.ВысотаТаблицы Цикл 
			
		СтрПоля = "";
		Для Каждого Элемент Из МассивОбязательныхКолонок Цикл
			Если ТабличныйДокумент.Область(НомерСтроки, Элемент).Текст = "" Тогда
				СтрПоля = СтрШаблон("%1%2; ", СтрПоля, ТабличныйДокумент.Область(1, Элемент).Текст);
			КонецЕсли;
		КонецЦикла;
		
		Если ЗначениеЗаполнено(СтрПоля) Тогда
			ЕстьНезаполненныеЗначения = Истина;
			Смещение = 2;         
			СтрПоля = Лев(СтрПоля, СтрДлина(СтрПоля) - Смещение);
			       
			СообщенияПредупреждения = СтрШаблон("Не заполнены обязательные поля в строке №%1 (%2)", НомерСтроки, СтрПоля);			
			ЗаписатьСообщение(СообщенияПредупреждения, НомерСтроки, 2);
        КонецЕсли;
		
		НСтр = СтрокиИзФайла.Добавить();
		НСтр.НомерСтроки = НомерСтроки;
		НСтр.ОбъектРемонта								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 1).Текст);
		НСтр.НаименованиеОР								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 2).Текст);
		НСтр.КодРодителя								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 3).Текст);
		НСтр.НаименованиеРодителя						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 4).Текст);
		НСтр.ДатаВводаВЭксплуатацию 					=  СтрокаВДату(СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 5).Текст));  	
		НСтр.ДатаВыпуска								=  СтрокаВДату(СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 6).Текст));	
		НСтр.Приоритет									=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 7).Текст); 
		НСтр.АдресМестонахождения						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 8).Текст);
		НСтр.ЗаводскойНомер								=  Сокрлп(ТабличныйДокумент.Область(НомерСтроки, 9).Текст); 
		НСтр.Изготовитель								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 10).Текст);
		НСтр.ИнвентарныйНомер 							=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 11).Текст);  
		НСтр.ТехНомер		 							=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 12).Текст);		
		НСтр.НомерПаспорта   							=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 13).Текст);
		НСтр.ПлановыйГрафикРабот  						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 14).Текст);
		// Подразделение
		НСтр.КодЭксплуатирующегоПодразделения 	 		=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 15).Текст);
		НСтр.НаименованиеЭксплуатирующегоПодразделения 	=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 16).Текст);
		// Подразделение исполнитель
		НСтр.КодРемонтирующегоПодразделения 			=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 17).Текст);
		НСтр.НаименованиеРемонтирующегоПодразделения 	=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 18).Текст);  
		НСтр.КодТиповогоОР 								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 19).Текст);
		НСтр.НаименованиеТиповогоОР 					=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 20).Текст);		
		НСтр.Модель										=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 21).Текст);
		НСтр.Марка										=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 22).Текст);
		НСтр.Гараж										=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 23).Текст);
		НСтр.ГаражныйНомер								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 24).Текст);
		НСтр.ГосНомер									=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 25).Текст);
		НСтр.ВИН										=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 26).Текст);
		НСтр.ЦветКузова									=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 27).Текст);
		НСтр.СобственныйВес								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 28).Текст);		
		НСтр.Колонна									=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 29).Текст);
		НСтр.ВидЛицензионнойКарточки					=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 30).Текст);
		НСтр.НомерЛицКарточки							=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 31).Текст);
		НСтр.РегистрационныйНомерЛицКарточки			=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 32).Текст);		
		НСтр.СерияЛицКарточки							=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 33).Текст);
		НСтр.НомерДвигателя								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 34).Текст);
		НСтр.МодельДвигателя							=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 35).Текст);
		НСтр.МощностьДвигателяКВТ						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 36).Текст);
		НСтр.МощностьДвигателяЛС						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 37).Текст);
		НСтр.НомерКузова								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 38).Текст);
		НСтр.НомерШасси									=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 39).Текст);
		НСтр.НомерКПП								    =  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 40).Текст);
		НСтр.ГабаритныйРазмерДлина						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 41).Текст);
	    НСтр.ГабаритныйРазмерШирина						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 42).Текст);    
		НСтр.ГабаритныйРазмерВысота						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 43).Текст); 
		НСтр.ВместимостьВКМ								=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 44).Текст);
		НСтр.ГрузоподъемностьВТоннах					=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 45).Текст);
	    НСтр.ПолезныйРазмерДлина						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 46).Текст); 
	    НСтр.ПолезныйРазмерШирина						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 47).Текст);    
		НСтр.ПолезныйРазмерВысота						=  СокрЛП(ТабличныйДокумент.Область(НомерСтроки, 48).Текст);  
		
	КонецЦикла;	
	
	ЗаполнитьПроверитьДанные(МассивЭлементовСправочника, СообщенияЗагрузки, СообщениеОшибки, СообщенияПредупреждения);			
		
	ВывестиРезультатыЗагрузки();
	
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = "Загрузка завершена";
	Сообщение.Сообщить();

КонецПроцедуры    

&НаСервере
Функция СтрокаВДату(Знач Значение)   
	
	Значение = СтрЗаменить(Значение, " ", "");
	Значение = СокрЛП(СтрЗаменить(Значение, ".", ""));
	Значение = СокрЛП(СтрЗаменить(Значение, "/", "")); 
	Значение = СокрЛП(СтрЗаменить(Значение, "-", "")); 
	Значение = Сред(Значение, 5) + Сред(Значение, 3, 2) + Лев(Значение, 2);     
	
	Если СтрДлина(Значение) = 6 Тогда 
		Год = СтроковыеФункцииКлиентСервер.СтрокаВЧисло(Лев(Значение, 2));
		Если Год = Неопределено Тогда
			Возврат Дата('0001.01.01');
		КонецЕсли; 
		Значение = ?(Год > 29, "19", "20") + Значение; 
	КонецЕсли;     
	
	ОписаниеТипа = Новый ОписаниеТипов("Дата"); 
	Результат    = ОписаниеТипа.ПривестиЗначение(Значение);
	Возврат Результат;  
	
КонецФункции 

&НаСервере
Функция ПолучитьСпособВыполнения(Текст)
	
	Если Текст = "Хозспособ" Тогда
		Возврат Перечисления.СпособыСтроительства.Хозспособ;
	ИначеЕсли Текст = "Подрядный" Тогда
		Возврат Перечисления.СпособыСтроительства.Подрядный;
	Иначе
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции
																	
&НаСервере
Процедура ВыполнитьЗаписьВБД(СообщенияЗагрузки, МассивЭлементовСправочника)
	
	ОсновнаяСтруктура = Справочники.проф_НастройкиСистемы.ПолучитьНастройкуСистемы(
							"НастройкиОбменаТОИР", "СтруктураИерархииПоУмочанию");
	
	Если ОсновнаяСтруктура = Неопределено
	Или Не ЗначениеЗаполнено(ОсновнаяСтруктура) Тогда
		ОсновнаяСтруктура = ПредопределенноеЗначение("Справочник.торо_СтруктурыОР.ПустаяСсылка");
	КонецЕсли;
	
	НачатьТранзакцию();
	
	Попытка

		// Запишем ссылки
		Для Каждого Эл Из МассивЭлементовСправочника Цикл
			
			СписокЗначенийПоСтроке = Эл.Значение;
			Запись = СписокЗначенийПоСтроке[0].Значение;
			РодительИерархии = СписокЗначенийПоСтроке[1].Значение;
 
			Если Не Запись.Ссылка.Пустая() Тогда           
				
				// Обновим элемент справочника
				ЗаполнитьНормативыПланирования(Запись, Истина);
				Запись.Записать();
				СообщенияЗагрузки = СтрШаблон("Запись строки №%1 обновлена%2", Эл.Ключ, Символы.ПС);
				ЗаписатьСообщение(СообщенияЗагрузки, Эл.Ключ, 3);

			Иначе         
				
				// Запишем новый элемент справочника
				Запись.Записать();
				ЗаполнитьНормативыПланирования(Запись, Ложь);
				
				// Запишем данные в РС
				// торо_ПорядокОРПоИерархии
				СледующийНомерДопУпорядочивания = ПолучитьСледующийНомерДопУпорядочивания(ОсновнаяСтруктура);
				ЗаписьР = РегистрыСведений.торо_ПорядокОРПоИерархии.СоздатьМенеджерЗаписи();
				ЗаписьР.ОбъектРемонта = Запись.Ссылка;
				ЗаписьР.СтруктураИерархии = ОсновнаяСтруктура;
				ЗаписьР.РеквизитДопУпорядочиванияОР = СледующийНомерДопУпорядочивания;
				ЗаписьР.Записать();  
				
				// торо_ИерархическиеСтруктурыОР
				Если ЗначениеЗаполнено(РодительИерархии) Тогда
					ЗаписьР2 = РегистрыСведений.торо_ИерархическиеСтруктурыОР.СоздатьМенеджерЗаписи();
					ЗаписьР2.ОбъектИерархии = Запись.Ссылка;
					ЗаписьР2.СтруктураИерархии = ОсновнаяСтруктура;
					ЗаписьР2.РодительИерархии = РодительИерархии;
					ЗаписьР2.Записать();  
				Иначе        
					СообщенияЗагрузки = СтрШаблон(
						"По строке №%1 не записаны данные в регистр ""Иерархические структуры, т.к. не найден родитель по коду %2",
						Эл.Ключ, Символы.ПС);
					ЗаписатьСообщение(СообщенияЗагрузки, Эл.Ключ, 3);	
				КонецЕсли;
				
				СообщенияЗагрузки = СтрШаблон("Запись строки №%1 загружена%2", Эл.Ключ, Символы.ПС);
				ЗаписатьСообщение(СообщенияЗагрузки, Эл.Ключ, 3);

			КонецЕсли;
			
		КонецЦикла;   
		ЗафиксироватьТранзакцию(); 
	Исключение
		ОтменитьТранзакцию();
		ОписаниеОшибки = ОбработкаОшибок.ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());		
		СообщенияЗагрузки = "Возникли ошибки при записи в базу данных. " + ОписаниеОшибки;   
		ЗаписатьСообщение(СообщенияЗагрузки, 1000000, 4);
	КонецПопытки;
	
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьСледующийНомерДопУпорядочивания(ОсновнаяСтруктура)     
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	МАКСИМУМ(торо_ПорядокОРПоИерархии.РеквизитДопУпорядочиванияОР) КАК РеквизитДопУпорядочиванияОР,
		|	торо_ПорядокОРПоИерархии.СтруктураИерархии КАК СтруктураИерархии
		|ИЗ
		|	РегистрСведений.торо_ПорядокОРПоИерархии КАК торо_ПорядокОРПоИерархии
		|ГДЕ
		|	торо_ПорядокОРПоИерархии.СтруктураИерархии = &СтруктураИерархии
		|
		|СГРУППИРОВАТЬ ПО
		|	торо_ПорядокОРПоИерархии.СтруктураИерархии";	
	Запрос.УстановитьПараметр("СтруктураИерархии", ОсновнаяСтруктура);
	РезультатЗапроса = Запрос.Выполнить();	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Возврат ВыборкаДетальныеЗаписи.РеквизитДопУпорядочиванияОР + 1;
	КонецЦикла;            
	
	Возврат 1;
	
КонецФункции

&НаСервере
Процедура ЗаполнитьСправочник(Стр, МассивЭлементовСправочника, ПриоритетПоУмолчанию)
	
	// Создадим запись в регистре торо_НормативныеРемонтыОборудования	
	Если Стр.ОбъектРемонта <> Неопределено
	И Стр.ОбъектРемонтаКолВо = 1
	И ЗначениеЗаполнено(Стр.НаименованиеОР) Тогда		
		ЭлементСправочника = Стр.ОбъектРемонта.ПолучитьОбъект();
	КонецЕсли;	
		
	Если Стр.ОбъектРемонта = Неопределено
	И ЗначениеЗаполнено(Стр.НаименованиеОР) Тогда
		// Элемент не был создан ранее      
		ЭлементСправочника = Справочники.торо_ОбъектыРемонта.СоздатьЭлемент();
		ЭлементСправочника.Код 							= Стр.ОбъектРемонтаКод;
		// Для новых ссылок заполним значения по умолчанию
		ЭлементСправочника.ВестиУчетСерийныхЗапчастей 	= Истина;	  
		ЭлементСправочника.Организация 					= Объект.Организация;
		ЭлементСправочника.ТипОбъекта 					= Перечисления.торо_ТипыОбъектовRCM.Объект;	
	КонецЕсли;
	
#Область ЗаполнениеРеквизитов   

    ЭлементСправочника.Наименование = Стр.НаименованиеОР;  
	Если Стр.Родитель <> Неопределено Тогда
		Родитель = Стр.Родитель;     
	Иначе
		Родитель = Неопределено;
	КонецЕсли;   
	Если Стр.ПлановыйГрафикРабот <> Неопределено Тогда
		ЭлементСправочника.ПлановыйГрафикРаботы = Стр.ПлановыйГрафикРабот;     
	КонецЕсли;     
	Если Стр.Подразделение <> Неопределено Тогда
		ЭлементСправочника.Подразделение = Стр.Подразделение;     
	КонецЕсли;
	Если Стр.РемонтирующееПодразделение <> Неопределено Тогда
		ЭлементСправочника.ПодразделениеИсполнитель = Стр.РемонтирующееПодразделение;     
	КонецЕсли;   
	Если Стр.ТиповойОР <> Неопределено Тогда
		ЭлементСправочника.ТиповойОР = Стр.ТиповойОР;     
	КонецЕсли;    
	Если Стр.Модель <> Неопределено Тогда
		ЭлементСправочника.проф_Модель = Стр.Модель;
	Иначе
		ЭлементСправочника.проф_Модель = Стр.МодельНаименование; // возможна строка в значении
	КонецЕсли;
    Если Стр.Изготовитель <> Неопределено Тогда
		ЭлементСправочника.Изготовитель = Стр.Изготовитель;
	Иначе
		ЭлементСправочника.Изготовитель = Стр.ИзготовительСтр; // возможна строка в значении
	КонецЕсли;
    Если Стр.Приоритет <> Неопределено Тогда
		ЭлементСправочника.Приоритет = Стр.Приоритет;     
	Иначе
		ЭлементСправочника.Приоритет = ПриоритетПоУмолчанию;   
	КонецЕсли; 
	
	ЭлементСправочника.ДатаВводаВЭксплуатацию = Стр.ДатаВводаВЭксплуатацию;    
	ЭлементСправочника.ДатаВыпуска = Стр.ДатаВыпуска;          
	ЭлементСправочника.ТехНомер = Стр.ТехНомер;  
	ЭлементСправочника.АдресМестонахождения = Стр.АдресМестонахождения;  
	ЭлементСправочника.ЗаводскойНомер = Стр.ЗаводскойНомер;    
	ЭлементСправочника.ИнвентарныйНомер = Стр.ИнвентарныйНомер;    
	ЭлементСправочника.НомерПаспорта = Стр.НомерПаспорта;    
	ЭлементСправочника.проф_Марка = Стр.Марка;    
	ЭлементСправочника.проф_Гараж = Стр.Гараж;    
	ЭлементСправочника.проф_ГаражныйНомер = Стр.ГаражныйНомер;    
	ЭлементСправочника.проф_VIN = Стр.ВИН;    
	ЭлементСправочника.проф_Госномер = Стр.ГосНомер;    
	ЭлементСправочника.проф_ЦветКузова = Стр.ЦветКузова;    
	ЭлементСправочника.проф_СобственныйВес = Стр.СобственныйВес;    
	ЭлементСправочника.проф_Колонна = Стр.Колонна;    
	ЭлементСправочника.проф_ЛицензионнаяКарточкаВид = Стр.ВидЛицензионнойКарточки;    
	ЭлементСправочника.проф_ЛицензионнаяКарточкаНомер = Стр.НомерЛицКарточки;    
	ЭлементСправочника.проф_ЛицензионнаяКарточкаРегистрационныйНомер = Стр.РегистрационныйНомерЛицКарточки;    	
	ЭлементСправочника.проф_ЛицензионнаяКарточкаСерия = Стр.СерияЛицКарточки;    
	ЭлементСправочника.проф_НомерДвигателя = Стр.НомерДвигателя;    
	ЭлементСправочника.проф_МодельДвигателя = Стр.МодельДвигателя;    
	ЭлементСправочника.проф_МощностьДвигателяКВт = Стр.МощностьДвигателяКВТ;    
	ЭлементСправочника.проф_МощностьДвигателяЛС = Стр.МощностьДвигателяЛС;    
	ЭлементСправочника.проф_НомерКузова = Стр.НомерКузова;    
	ЭлементСправочника.проф_НомерШасси = Стр.НомерШасси;    
	ЭлементСправочника.проф_НомерКПП = Стр.НомерКПП;       
	ЭлементСправочника.проф_ГабаритныйРазмерДлина = Стр.ГабаритныйРазмерДлина;    
	ЭлементСправочника.проф_ГабаритныйРазмерШирина = Стр.ГабаритныйРазмерШирина;      
	ЭлементСправочника.проф_ГабаритныйРазмерВысота = Стр.ГабаритныйРазмерВысота;    
	ЭлементСправочника.проф_ПолезныйРазмерВысота = Стр.ПолезныйРазмерВысота;    
	ЭлементСправочника.проф_ПолезныйРазмерДлина = Стр.ПолезныйРазмерДлина;      
	ЭлементСправочника.проф_ПолезныйРазмерШирина = Стр.ПолезныйРазмерШирина;    
	ЭлементСправочника.проф_ВместимостьВКубическихМетрах = Стр.ВместимостьВКМ;    
	ЭлементСправочника.проф_ГрузоподъемностьВТоннах = Стр.ГрузоподъемностьВТоннах;    

#КонецОбласти

	СписокЗначенийПоСтроке = Новый СписокЗначений;
	СписокЗначенийПоСтроке.Добавить(ЭлементСправочника);
	СписокЗначенийПоСтроке.Добавить(Родитель);

	МассивЭлементовСправочника.Вставить(Стр.НомерСтроки, СписокЗначенийПоСтроке);
		
КонецПроцедуры

&НаСервере
Функция ПолучитьДанныеДляПроверкиИЗаполнения()
	
	ТЗ = РеквизитФормыВЗначение("СтрокиИзФайла");
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ВнешнийИсточник.ОбъектРемонта КАК ОбъектРемонта,
	               |	ВнешнийИсточник.НаименованиеОР КАК НаименованиеОР,
	               |	ВнешнийИсточник.НомерСтроки КАК НомерСтроки,
	               |	ВнешнийИсточник.КодРодителя КАК КодРодителя,
	               |	ВнешнийИсточник.НаименованиеРодителя КАК НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию КАК ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска КАК ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер КАК ТехНомер,
	               |	ВнешнийИсточник.Приоритет КАК Приоритет,
	               |	ВнешнийИсточник.АдресМестонахождения КАК АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер КАК ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер КАК ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта КАК НомерПаспорта,
	               |	ВнешнийИсточник.ПлановыйГрафикРабот КАК ПлановыйГрафикРабот,
	               |	ВнешнийИсточник.КодЭксплуатирующегоПодразделения КАК КодЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения КАК НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.КодРемонтирующегоПодразделения КАК КодРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения КАК НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.КодТиповогоОР КАК КодТиповогоОР,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР КАК НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Модель КАК Модель,
	               |	ВнешнийИсточник.Марка КАК Марка,
	               |	ВнешнийИсточник.Гараж КАК Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер КАК ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН КАК ВИН,
	               |	ВнешнийИсточник.ГосНомер КАК ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова КАК ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес КАК СобственныйВес,
	               |	ВнешнийИсточник.Изготовитель КАК ИзготовительСтр,
	               |	ВнешнийИсточник.Колонна КАК Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки КАК ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки КАК НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки КАК РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки КАК СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя КАК НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя КАК МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ КАК МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС КАК МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова КАК НомерКузова,
	               |	ВнешнийИсточник.НомерШасси КАК НомерШасси,
	               |	ВнешнийИсточник.НомерКПП КАК НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина КАК ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина КАК ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота КАК ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота КАК ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина КАК ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина КАК ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ КАК ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах КАК ГрузоподъемностьВТоннах
	               |ПОМЕСТИТЬ ВнешнийИсточник
	               |ИЗ
	               |	&ТЗ КАК ВнешнийИсточник
	               |
	               |ИНДЕКСИРОВАТЬ ПО
	               |	ОбъектРемонта,
	               |	КодРодителя,
	               |	КодРемонтирующегоПодразделения,
	               |	КодЭксплуатирующегоПодразделения,
	               |	ПлановыйГрафикРабот,
	               |	КодТиповогоОР,
	               |	Модель,
	               |	Приоритет,
	               |	ИзготовительСтр
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	торо_ОбъектыРемонта.Ссылка КАК Ссылка,
	               |	торо_ОбъектыРемонта.Код КАК Код
	               |ПОМЕСТИТЬ ОбъектыРемонта
	               |ИЗ
	               |	Справочник.торо_ОбъектыРемонта КАК торо_ОбъектыРемонта
	               |
	               |ИНДЕКСИРОВАТЬ ПО
	               |	Код
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	торо_ТиповыеОР.Ссылка КАК Ссылка,
	               |	торо_ТиповыеОР.Код КАК Код
	               |ПОМЕСТИТЬ ТиповыеОР
	               |ИЗ
	               |	Справочник.торо_ТиповыеОР КАК торо_ТиповыеОР
	               |
	               |ИНДЕКСИРОВАТЬ ПО
	               |	Код
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	СтруктураПредприятия.Ссылка КАК Ссылка,
	               |	СтруктураПредприятия.Код КАК Код
	               |ПОМЕСТИТЬ СтруктураПредприятия
	               |ИЗ
	               |	Справочник.СтруктураПредприятия КАК СтруктураПредприятия
	               |
	               |ИНДЕКСИРОВАТЬ ПО
	               |	Код
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	Производители.Ссылка КАК Ссылка,
	               |	Производители.Наименование КАК Наименование
	               |ПОМЕСТИТЬ Производители
	               |ИЗ
	               |	Справочник.Производители КАК Производители
	               |
	               |ИНДЕКСИРОВАТЬ ПО
	               |	Наименование
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	проф_МоделиТСиОборудования.Ссылка КАК Ссылка,
	               |	проф_МоделиТСиОборудования.Наименование КАК Наименование
	               |ПОМЕСТИТЬ проф_МоделиТСиОборудования
	               |ИЗ
	               |	Справочник.проф_МоделиТСиОборудования КАК проф_МоделиТСиОборудования
	               |
	               |ИНДЕКСИРОВАТЬ ПО
	               |	Наименование
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	ВнешнийИсточник.ОбъектРемонта КАК ОбъектРемонтаКод,
	               |	ВнешнийИсточник.НаименованиеОР КАК НаименованиеОР,
	               |	ВнешнийИсточник.НаименованиеРодителя КАК НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию КАК ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска КАК ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер КАК ТехНомер,
	               |	ВнешнийИсточник.АдресМестонахождения КАК АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер КАК ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер КАК ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта КАК НомерПаспорта,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения КАК НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения КАК НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР КАК НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Модель КАК МодельНаименование,
	               |	ВнешнийИсточник.Марка КАК Марка,
	               |	ВнешнийИсточник.Гараж КАК Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер КАК ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН КАК ВИН,
	               |	ВнешнийИсточник.ГосНомер КАК ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова КАК ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес КАК СобственныйВес,
	               |	ВнешнийИсточник.ИзготовительСтр КАК ИзготовительСтр,
	               |	ВнешнийИсточник.Колонна КАК Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки КАК ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки КАК НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки КАК РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки КАК СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя КАК НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя КАК МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ КАК МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС КАК МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова КАК НомерКузова,
	               |	ВнешнийИсточник.НомерШасси КАК НомерШасси,
	               |	ВнешнийИсточник.НомерКПП КАК НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина КАК ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина КАК ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота КАК ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота КАК ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина КАК ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина КАК ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ КАК ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах КАК ГрузоподъемностьВТоннах,
	               |	ВнешнийИсточник.ПлановыйГрафикРабот КАК ПлановыйГрафикРабот,
	               |	ВнешнийИсточник.Приоритет КАК Приоритет,
	               |	ВнешнийИсточник.КодТиповогоОР КАК КодТиповогоОР,
	               |	ВнешнийИсточник.КодЭксплуатирующегоПодразделения КАК КодЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.КодРемонтирующегоПодразделения КАК КодРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.Модель КАК Модель,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(ОбъектыРемонта.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ОбъектРемонтаКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(ОбъектыРемонта.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ОбъектРемонта,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(ОбъектыРемонтаГруппы.Ссылка, НЕОПРЕДЕЛЕНО)) КАК РодительКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(ОбъектыРемонтаГруппы.Ссылка, НЕОПРЕДЕЛЕНО)) КАК Родитель,
	               |	ВнешнийИсточник.НомерСтроки КАК НомерСтроки
	               |ПОМЕСТИТЬ ВнешнийИсточник2
	               |ИЗ
	               |	ВнешнийИсточник КАК ВнешнийИсточник
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ОбъектыРемонта КАК ОбъектыРемонта
	               |		ПО ВнешнийИсточник.ОбъектРемонта = ОбъектыРемонта.Код
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ОбъектыРемонта КАК ОбъектыРемонтаГруппы
	               |		ПО ВнешнийИсточник.КодРодителя = ОбъектыРемонтаГруппы.Код
	               |
	               |СГРУППИРОВАТЬ ПО
	               |	ВнешнийИсточник.НомерСтроки,
	               |	ВнешнийИсточник.ОбъектРемонта,
	               |	ВнешнийИсточник.ПлановыйГрафикРабот,
	               |	ВнешнийИсточник.КодТиповогоОР,
	               |	ВнешнийИсточник.Приоритет,
	               |	ВнешнийИсточник.КодЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.КодРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.ИзготовительСтр,
	               |	ВнешнийИсточник.Модель,
	               |	ВнешнийИсточник.НаименованиеОР,
	               |	ВнешнийИсточник.НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер,
	               |	ВнешнийИсточник.АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Марка,
	               |	ВнешнийИсточник.Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН,
	               |	ВнешнийИсточник.ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес,
	               |	ВнешнийИсточник.Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова,
	               |	ВнешнийИсточник.НомерШасси,
	               |	ВнешнийИсточник.НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах,
	               |	ВнешнийИсточник.Модель
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	ВнешнийИсточник.ОбъектРемонтаКод КАК ОбъектРемонтаКод,
	               |	ВнешнийИсточник.ОбъектРемонтаКолВо КАК ОбъектРемонтаКолВо,
	               |	ВнешнийИсточник.ОбъектРемонта КАК ОбъектРемонта,
	               |	ВнешнийИсточник.РодительКолВо КАК РодительКолВо,
	               |	ВнешнийИсточник.Родитель КАК Родитель,
	               |	ВнешнийИсточник.НаименованиеОР КАК НаименованиеОР,
	               |	ВнешнийИсточник.НаименованиеРодителя КАК НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию КАК ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска КАК ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер КАК ТехНомер,
	               |	ВнешнийИсточник.АдресМестонахождения КАК АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер КАК ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер КАК ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта КАК НомерПаспорта,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения КАК НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения КАК НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР КАК НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Модель КАК МодельНаименование,
	               |	ВнешнийИсточник.Марка КАК Марка,
	               |	ВнешнийИсточник.Гараж КАК Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер КАК ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН КАК ВИН,
	               |	ВнешнийИсточник.ГосНомер КАК ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова КАК ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес КАК СобственныйВес,
	               |	ВнешнийИсточник.ИзготовительСтр КАК ИзготовительСтр,
	               |	ВнешнийИсточник.Колонна КАК Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки КАК ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки КАК НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки КАК РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки КАК СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя КАК НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя КАК МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ КАК МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС КАК МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова КАК НомерКузова,
	               |	ВнешнийИсточник.НомерШасси КАК НомерШасси,
	               |	ВнешнийИсточник.НомерКПП КАК НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина КАК ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина КАК ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота КАК ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота КАК ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина КАК ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина КАК ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ КАК ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах КАК ГрузоподъемностьВТоннах,
	               |	ВнешнийИсточник.ПлановыйГрафикРабот КАК ПлановыйГрафикРабот,
	               |	ВнешнийИсточник.Приоритет КАК Приоритет,
	               |	ВнешнийИсточник.КодТиповогоОР КАК КодТиповогоОР,
	               |	ВнешнийИсточник.Модель КАК Модель,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(СтруктураПредприятия.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ПодразделениеКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(СтруктураПредприятия.Ссылка, НЕОПРЕДЕЛЕНО)) КАК Подразделение,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(СтруктураПредприятия2.Ссылка, НЕОПРЕДЕЛЕНО)) КАК РемонтирующееПодразделениеКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(СтруктураПредприятия2.Ссылка, НЕОПРЕДЕЛЕНО)) КАК РемонтирующееПодразделение,
	               |	ВнешнийИсточник.НомерСтроки КАК НомерСтроки
	               |ПОМЕСТИТЬ ВнешнийИсточник3
	               |ИЗ
	               |	ВнешнийИсточник2 КАК ВнешнийИсточник
	               |		ЛЕВОЕ СОЕДИНЕНИЕ СтруктураПредприятия КАК СтруктураПредприятия
	               |		ПО ВнешнийИсточник.КодЭксплуатирующегоПодразделения = СтруктураПредприятия.Код
	               |		ЛЕВОЕ СОЕДИНЕНИЕ СтруктураПредприятия КАК СтруктураПредприятия2
	               |		ПО ВнешнийИсточник.КодРемонтирующегоПодразделения = СтруктураПредприятия2.Код
	               |
	               |СГРУППИРОВАТЬ ПО
	               |	ВнешнийИсточник.НомерСтроки,
	               |	ВнешнийИсточник.ОбъектРемонтаКод,
	               |	ВнешнийИсточник.ОбъектРемонтаКолВо,
	               |	ВнешнийИсточник.ОбъектРемонта,
	               |	ВнешнийИсточник.РодительКолВо,
	               |	ВнешнийИсточник.Родитель,
	               |	ВнешнийИсточник.ПлановыйГрафикРабот,
	               |	ВнешнийИсточник.Приоритет,
	               |	ВнешнийИсточник.КодТиповогоОР,
	               |	ВнешнийИсточник.Модель,
	               |	ВнешнийИсточник.ИзготовительСтр,
	               |	ВнешнийИсточник.НаименованиеОР,
	               |	ВнешнийИсточник.НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер,
	               |	ВнешнийИсточник.АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Марка,
	               |	ВнешнийИсточник.Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН,
	               |	ВнешнийИсточник.ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес,
	               |	ВнешнийИсточник.Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова,
	               |	ВнешнийИсточник.НомерШасси,
	               |	ВнешнийИсточник.НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах,
	               |	ВнешнийИсточник.Модель
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ
	               |	ВнешнийИсточник.ОбъектРемонтаКод КАК ОбъектРемонтаКод,
	               |	ВнешнийИсточник.ОбъектРемонтаКолВо КАК ОбъектРемонтаКолВо,
	               |	ВнешнийИсточник.ОбъектРемонта КАК ОбъектРемонта,
	               |	ВнешнийИсточник.РодительКолВо КАК РодительКолВо,
	               |	ВнешнийИсточник.Родитель КАК Родитель,
	               |	ВнешнийИсточник.ПодразделениеКолВо КАК ПодразделениеКолВо,
	               |	ВнешнийИсточник.РемонтирующееПодразделениеКолВо КАК РемонтирующееПодразделениеКолВо,
	               |	ВнешнийИсточник.РемонтирующееПодразделение КАК РемонтирующееПодразделение,
	               |	ВнешнийИсточник.Подразделение КАК Подразделение,
	               |	ВнешнийИсточник.НаименованиеОР КАК НаименованиеОР,
	               |	ВнешнийИсточник.НаименованиеРодителя КАК НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию КАК ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска КАК ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер КАК ТехНомер,
	               |	ВнешнийИсточник.АдресМестонахождения КАК АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер КАК ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер КАК ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта КАК НомерПаспорта,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения КАК НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения КАК НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР КАК НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Модель КАК МодельНаименование,
	               |	ВнешнийИсточник.Марка КАК Марка,
	               |	ВнешнийИсточник.Гараж КАК Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер КАК ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН КАК ВИН,
	               |	ВнешнийИсточник.ГосНомер КАК ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова КАК ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес КАК СобственныйВес,
	               |	ВнешнийИсточник.ИзготовительСтр КАК ИзготовительСтр,
	               |	ВнешнийИсточник.Колонна КАК Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки КАК ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки КАК НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки КАК РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки КАК СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя КАК НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя КАК МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ КАК МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС КАК МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова КАК НомерКузова,
	               |	ВнешнийИсточник.НомерШасси КАК НомерШасси,
	               |	ВнешнийИсточник.НомерКПП КАК НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина КАК ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина КАК ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота КАК ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота КАК ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина КАК ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина КАК ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ КАК ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах КАК ГрузоподъемностьВТоннах,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(Календари.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ПлановыйГрафикРаботКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(Календари.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ПлановыйГрафикРабот,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(ТиповыеОР.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ТиповойОРКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(ТиповыеОР.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ТиповойОР,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(проф_МоделиТСиОборудования.Ссылка, НЕОПРЕДЕЛЕНО)) КАК МодельКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(проф_МоделиТСиОборудования.Ссылка, НЕОПРЕДЕЛЕНО)) КАК Модель,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(торо_ПриоритетыОбъектовРемонта.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ПриоритетКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(торо_ПриоритетыОбъектовРемонта.Ссылка, НЕОПРЕДЕЛЕНО)) КАК Приоритет,
	               |	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ЕСТЬNULL(Производители.Ссылка, НЕОПРЕДЕЛЕНО)) КАК ИзготовительКолВо,
	               |	МАКСИМУМ(ЕСТЬNULL(Производители.Ссылка, НЕОПРЕДЕЛЕНО)) КАК Изготовитель,
	               |	ВнешнийИсточник.НомерСтроки КАК НомерСтроки
	               |ИЗ
	               |	ВнешнийИсточник3 КАК ВнешнийИсточник
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Календари КАК Календари
	               |		ПО ВнешнийИсточник.ПлановыйГрафикРабот = Календари.Наименование
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.торо_ПриоритетыОбъектовРемонта КАК торо_ПриоритетыОбъектовРемонта
	               |		ПО ВнешнийИсточник.Приоритет = торо_ПриоритетыОбъектовРемонта.Наименование
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ТиповыеОР КАК ТиповыеОР
	               |		ПО ВнешнийИсточник.КодТиповогоОР = ТиповыеОР.Код
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Производители КАК Производители
	               |		ПО ВнешнийИсточник.ИзготовительСтр = Производители.Наименование
	               |		ЛЕВОЕ СОЕДИНЕНИЕ проф_МоделиТСиОборудования КАК проф_МоделиТСиОборудования
	               |		ПО ВнешнийИсточник.Модель = проф_МоделиТСиОборудования.Наименование
	               |
	               |СГРУППИРОВАТЬ ПО
	               |	ВнешнийИсточник.НомерСтроки,
	               |	ВнешнийИсточник.ОбъектРемонтаКод,
	               |	ВнешнийИсточник.ОбъектРемонтаКолВо,
	               |	ВнешнийИсточник.ОбъектРемонта,
	               |	ВнешнийИсточник.РодительКолВо,
	               |	ВнешнийИсточник.Родитель,
	               |	ВнешнийИсточник.ПодразделениеКолВо,
	               |	ВнешнийИсточник.РемонтирующееПодразделениеКолВо,
	               |	ВнешнийИсточник.РемонтирующееПодразделение,
	               |	ВнешнийИсточник.Подразделение,
	               |	ВнешнийИсточник.НаименованиеОР,
	               |	ВнешнийИсточник.НаименованиеРодителя,
	               |	ВнешнийИсточник.ДатаВводаВЭксплуатацию,
	               |	ВнешнийИсточник.ДатаВыпуска,
	               |	ВнешнийИсточник.ТехНомер,
	               |	ВнешнийИсточник.АдресМестонахождения,
	               |	ВнешнийИсточник.ЗаводскойНомер,
	               |	ВнешнийИсточник.ИнвентарныйНомер,
	               |	ВнешнийИсточник.НомерПаспорта,
	               |	ВнешнийИсточник.НаименованиеЭксплуатирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеРемонтирующегоПодразделения,
	               |	ВнешнийИсточник.НаименованиеТиповогоОР,
	               |	ВнешнийИсточник.Модель,
	               |	ВнешнийИсточник.Марка,
	               |	ВнешнийИсточник.Гараж,
	               |	ВнешнийИсточник.ГаражныйНомер,
	               |	ВнешнийИсточник.ВИН,
	               |	ВнешнийИсточник.ГосНомер,
	               |	ВнешнийИсточник.ЦветКузова,
	               |	ВнешнийИсточник.СобственныйВес,
	               |	ВнешнийИсточник.ИзготовительСтр,
	               |	ВнешнийИсточник.Колонна,
	               |	ВнешнийИсточник.ВидЛицензионнойКарточки,
	               |	ВнешнийИсточник.НомерЛицКарточки,
	               |	ВнешнийИсточник.РегистрационныйНомерЛицКарточки,
	               |	ВнешнийИсточник.СерияЛицКарточки,
	               |	ВнешнийИсточник.НомерДвигателя,
	               |	ВнешнийИсточник.МодельДвигателя,
	               |	ВнешнийИсточник.МощностьДвигателяКВТ,
	               |	ВнешнийИсточник.МощностьДвигателяЛС,
	               |	ВнешнийИсточник.НомерКузова,
	               |	ВнешнийИсточник.НомерШасси,
	               |	ВнешнийИсточник.НомерКПП,
	               |	ВнешнийИсточник.ГабаритныйРазмерДлина,
	               |	ВнешнийИсточник.ГабаритныйРазмерШирина,
	               |	ВнешнийИсточник.ГабаритныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерВысота,
	               |	ВнешнийИсточник.ПолезныйРазмерДлина,
	               |	ВнешнийИсточник.ПолезныйРазмерШирина,
	               |	ВнешнийИсточник.ВместимостьВКМ,
	               |	ВнешнийИсточник.ГрузоподъемностьВТоннах
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	НомерСтроки УБЫВ";
	
	Запрос.УстановитьПараметр("ТЗ", ТЗ);			   
	РезультатЗапроса = Запрос.Выполнить().Выбрать();
	
	Возврат РезультатЗапроса;
	
КонецФункции

&НаСервере
Функция ПолучитьСписокОбязательныхКолонок()
	
	М = Новый Массив();
	М.Добавить(1); 
	М.Добавить(2);
	М.Добавить(5);
	М.Добавить(6);
	М.Добавить(14);
	М.Добавить(15);
		
	Возврат М;
	
КонецФункции

&НаСервере
Функция ПолучитьСпособУчетаДатыОтсчета(Наименование)
	
	Если Наименование = "По последнему ремонту или дате планирования" Тогда
		Возврат Перечисления.торо_СпособыУчетаДатыОтсчетаПриПланированииРемонтныхРабот.ПоПоследнемуРемонтуИлиДатеПланирования;
		
	ИначеЕсли Наименование = "По дате ввода в эксплуатацию или последнему ремонту" Тогда
		Возврат Перечисления.торо_СпособыУчетаДатыОтсчетаПриПланированииРемонтныхРабот.ИспользоватьДатуВводаВЭксплуатацию;
		
	ИначеЕсли Наименование = "Использовать дату планирования" Тогда
		Возврат Перечисления.торо_СпособыУчетаДатыОтсчетаПриПланированииРемонтныхРабот.ИспользоватьДатуПланированияВКачествеДатыОтсчета;
		
	ИначеЕсли Наименование = "По последнему ремонту" Тогда
		Возврат Перечисления.торо_СпособыУчетаДатыОтсчетаПриПланированииРемонтныхРабот.НеИспользоватьДатуВводаВЭксплуатацию;
		
	ИначеЕсли Наименование = "По дате ввода в эксплуатацию или плановым датам" Тогда
		Возврат Перечисления.торо_СпособыУчетаДатыОтсчетаПриПланированииРемонтныхРабот.ПоДатеВводаВЭксплуатациюИлиПлановымДатам;   
		
	Иначе 
		Возврат Неопределено;
	КонецЕсли;
	
КонецФункции

&НаСервере
Процедура ЗаполнитьПроверитьДанные(МассивЭлементовСправочника,
								  СообщенияЗагрузки,
								  СообщениеОшибки,
								  СообщенияПредупреждения)
	
	ПриоритетПоУмолчанию = Справочники.проф_НастройкиСистемы.ПолучитьНастройкуСистемы(
								"НастройкиОбменаТОИР", "ПриоритетОбъектаРемонтаПоУмолчанию");
	
	Если ПриоритетПоУмолчанию = Неопределено
	Или Не ЗначениеЗаполнено(ПриоритетПоУмолчанию) Тогда
		ПриоритетПоУмолчанию = ПредопределенноеЗначение("Справочник.торо_ПриоритетыОбъектовРемонта.ПустаяСсылка");		
	КонецЕсли;
	
	ДополненныеДанные = ПолучитьДанныеДляПроверкиИЗаполнения();
	ЕстьНезаполненныеНаименованиеОР = Ложь;
	
	// Обработка данных и формирование массива записей регистра
	Пока ДополненныеДанные.Следующий() Цикл
		
		Стр = ДополненныеДанные;
						
		ПроверитьДополнительноДанные(Стр, СообщенияПредупреждения);
		Если ЕстьОшибкиПоОбязательнымИзмерениям(Стр, СообщенияПредупреждения) Тогда
			Продолжить;
		КонецЕсли;      
		
		ЗаполнитьСправочник(Стр, МассивЭлементовСправочника, ПриоритетПоУмолчанию);
		
	КонецЦикла;
	
	ВыполнитьЗаписьВБД(СообщенияЗагрузки, МассивЭлементовСправочника); 
    	
КонецПроцедуры	

&НаСервере
Процедура ПроверитьДополнительноДанные(Стр, СообщенияПредупреждения)
	
	Если Стр.ПлановыйГрафикРабот = Неопределено Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 не найдено значение обязательного" +
			" поля шаблона ""Плановый график работы""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);    
	КонецЕсли; 
	
	Если Стр.ПлановыйГрафикРаботКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Плановый график работы""", Стр.НомерСтроки);   
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);  
	КонецЕсли;   
	
    Если Стр.РодительКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Код родителя ОР""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.Родитель = Неопределено Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 не найдено значение" +
			" поля шаблона ""Код родителя ОР""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;

	Если Стр.ПодразделениеКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Код эксплуатирующего подразделения""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.Подразделение = Неопределено Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 не найдено значение обязательного" +
			" поля шаблона ""Код эксплуатирующего подразделения""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.РемонтирующееПодразделениеКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Код ремонтирующего подразделения""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.РемонтирующееПодразделение = Неопределено Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 не найдено значение" +
			" поля шаблона ""Код ремонтирующего подразделения""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.ТиповойОРКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Код типового объекта ремонта""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.ТиповойОР = Неопределено Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 не найдено значение" +
			" поля шаблона ""Код типового объекта ремонта""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;	
	
	Если Стр.МодельКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Модель""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.ИзготовительКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Изготовитель""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.ПриоритетКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Критичность""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;
	
	Если Стр.Приоритет = Неопределено Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 не найдено значение" +
			" поля шаблона ""Критичность"". Будет использовано значение по умолчанию (Настройки системы (Проф-ИТ)).", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);
	КонецЕсли;

КонецПроцедуры	

&НаСервере
Функция ЕстьОшибкиПоОбязательнымИзмерениям(Стр, СообщенияПредупреждения)
	
	ЕстьОшибкаПоОбязательнымИзмерениям = Ложь;  
	
	Если Стр.ОбъектРемонтаКолВо > 1 Тогда				
		СообщенияПредупреждения = СтрШаблон("В строке №%1 найдено более одного значения" +
			" для поля шаблона ""Код объекта ремонта""", Стр.НомерСтроки);   
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 2);  
		ЕстьОшибкаПоОбязательнымИзмерениям = Истина;
	КонецЕсли;  
	
	Если Не ЗначениеЗаполнено(Стр.НаименованиеОР) Тогда				
		СообщенияПредупреждения = СтрШаблон("Запись из номера строки №%1 не загружена,"+
			" т.к. не заполнено поле ""Наименование объекта ремонта(узла)""", Стр.НомерСтроки); 
		ЗаписатьСообщение(СообщенияПредупреждения, Стр.НомерСтроки, 4);     
		ЕстьОшибкаПоОбязательнымИзмерениям = Истина;
	КонецЕсли; 
	
	Возврат ЕстьОшибкаПоОбязательнымИзмерениям;
	
КонецФункции	

#КонецОбласти

//-- Проф-ИТ, #33, Башинская А., 13.10.2023	
